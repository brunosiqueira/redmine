<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='en' xml:lang='en' xmlns='http://www.w3.org/1999/xhtml'><head><title>lib/SVG/Graph/Graph.rb - C0 code coverage information</title>
    <style type='text/css'>body { background-color: rgb(240, 240, 245); }</style>
    <style type='text/css'>span.cross-ref-title {
 font-size: 140%;
}
span.cross-ref a {
 text-decoration: none;
}
span.cross-ref {
 background-color:#f3f7fa;
 border: 1px dashed #333;
 margin: 1em;
 padding: 0.5em;
 overflow: hidden;
}
a.crossref-toggle {
 text-decoration: none;
}
span.marked0 {
 background-color: rgb(185, 210, 200);
 display: block;
}
span.marked1 {
 background-color: rgb(190, 215, 205);
 display: block;
}
span.inferred0 {
 background-color: rgb(175, 200, 200);
 display: block;
}
span.inferred1 {
 background-color: rgb(180, 205, 205);
 display: block;
}
span.uncovered0 {
 background-color: rgb(225, 110, 110);
 display: block;
}
span.uncovered1 {
 background-color: rgb(235, 120, 120);
 display: block;
}
span.overview {
 border-bottom: 8px solid black;
}
div.overview {
 border-bottom: 8px solid black;
}
body {
 font-family: verdana, arial, helvetica;
}
div.footer {
 font-size: 68%;
 margin-top: 1.5em;
}
h1, h2, h3, h4, h5, h6 {
 margin-bottom: 0.5em;
}
h5 {
 margin-top: 0.5em;
}
.hidden {
 display: none;
}
div.separator {
 height: 10px;
}
/* Commented out for better readability, esp. on IE */
/*
table tr td, table tr th {
 font-size: 68%;
}
td.value table tr td {
 font-size: 11px;
}
*/
table.percent_graph {
 height: 12px;
 border: #808080 1px solid;
 empty-cells: show;
}
table.percent_graph td.covered {
 height: 10px;
 background: #00f000;
}
table.percent_graph td.uncovered {
 height: 10px;
 background: #e00000;
}
table.percent_graph td.NA {
 height: 10px;
 background: #eaeaea;
}
table.report {
 border-collapse: collapse;
 width: 100%;
}
table.report td.heading {
 background: #dcecff;
 border: #d0d0d0 1px solid;
 font-weight: bold;
 text-align: center;
}
table.report td.heading:hover {
 background: #c0ffc0;
}
table.report td.text {
 border: #d0d0d0 1px solid;
}
table.report td.value,
table.report td.lines_total,
table.report td.lines_code {
 text-align: right;
 border: #d0d0d0 1px solid;
}
table.report tr.light {
 background-color: rgb(240, 240, 245);
}
table.report tr.dark {
 background-color: rgb(230, 230, 235);
}
</style>
    <script type='text/javascript'>
// <![CDATA[
  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make cross-references hidden by default
  document.writeln( "<style type=\"text/css\">span.cross-ref { display: none }</style>" )
  // ]]>
</script>
    <style type='text/css'>span.run0 {
  background-color: rgb(178, 204, 255);
  display: block;
}
span.run1 {
  background-color: rgb(178, 206, 255);
  display: block;
}
span.run2 {
  background-color: rgb(178, 209, 255);
  display: block;
}
span.run3 {
  background-color: rgb(178, 211, 255);
  display: block;
}
span.run4 {
  background-color: rgb(178, 214, 255);
  display: block;
}
span.run5 {
  background-color: rgb(178, 218, 255);
  display: block;
}
span.run6 {
  background-color: rgb(178, 220, 255);
  display: block;
}
span.run7 {
  background-color: rgb(178, 223, 255);
  display: block;
}
span.run8 {
  background-color: rgb(178, 225, 255);
  display: block;
}
span.run9 {
  background-color: rgb(178, 228, 255);
  display: block;
}
span.run10 {
  background-color: rgb(178, 232, 255);
  display: block;
}
span.run11 {
  background-color: rgb(178, 234, 255);
  display: block;
}
span.run12 {
  background-color: rgb(178, 237, 255);
  display: block;
}
span.run13 {
  background-color: rgb(178, 239, 255);
  display: block;
}
span.run14 {
  background-color: rgb(178, 242, 255);
  display: block;
}
span.run15 {
  background-color: rgb(178, 246, 255);
  display: block;
}
span.run16 {
  background-color: rgb(178, 248, 255);
  display: block;
}
span.run17 {
  background-color: rgb(178, 251, 255);
  display: block;
}
span.run18 {
  background-color: rgb(178, 253, 255);
  display: block;
}
span.run19 {
  background-color: rgb(178, 255, 253);
  display: block;
}
span.run20 {
  background-color: rgb(178, 255, 249);
  display: block;
}
span.run21 {
  background-color: rgb(178, 255, 247);
  display: block;
}
span.run22 {
  background-color: rgb(178, 255, 244);
  display: block;
}
span.run23 {
  background-color: rgb(178, 255, 242);
  display: block;
}
span.run24 {
  background-color: rgb(178, 255, 239);
  display: block;
}
span.run25 {
  background-color: rgb(178, 255, 235);
  display: block;
}
span.run26 {
  background-color: rgb(178, 255, 233);
  display: block;
}
span.run27 {
  background-color: rgb(178, 255, 230);
  display: block;
}
span.run28 {
  background-color: rgb(178, 255, 228);
  display: block;
}
span.run29 {
  background-color: rgb(178, 255, 225);
  display: block;
}
span.run30 {
  background-color: rgb(178, 255, 221);
  display: block;
}
span.run31 {
  background-color: rgb(178, 255, 219);
  display: block;
}
span.run32 {
  background-color: rgb(178, 255, 216);
  display: block;
}
span.run33 {
  background-color: rgb(178, 255, 214);
  display: block;
}
span.run34 {
  background-color: rgb(178, 255, 211);
  display: block;
}
span.run35 {
  background-color: rgb(178, 255, 207);
  display: block;
}
span.run36 {
  background-color: rgb(178, 255, 205);
  display: block;
}
span.run37 {
  background-color: rgb(178, 255, 202);
  display: block;
}
span.run38 {
  background-color: rgb(178, 255, 200);
  display: block;
}
span.run39 {
  background-color: rgb(178, 255, 197);
  display: block;
}
span.run40 {
  background-color: rgb(178, 255, 193);
  display: block;
}
span.run41 {
  background-color: rgb(178, 255, 191);
  display: block;
}
span.run42 {
  background-color: rgb(178, 255, 188);
  display: block;
}
span.run43 {
  background-color: rgb(178, 255, 186);
  display: block;
}
span.run44 {
  background-color: rgb(178, 255, 183);
  display: block;
}
span.run45 {
  background-color: rgb(178, 255, 179);
  display: block;
}
span.run46 {
  background-color: rgb(179, 255, 178);
  display: block;
}
span.run47 {
  background-color: rgb(182, 255, 178);
  display: block;
}
span.run48 {
  background-color: rgb(184, 255, 178);
  display: block;
}
span.run49 {
  background-color: rgb(187, 255, 178);
  display: block;
}
span.run50 {
  background-color: rgb(191, 255, 178);
  display: block;
}
span.run51 {
  background-color: rgb(193, 255, 178);
  display: block;
}
span.run52 {
  background-color: rgb(196, 255, 178);
  display: block;
}
span.run53 {
  background-color: rgb(198, 255, 178);
  display: block;
}
span.run54 {
  background-color: rgb(201, 255, 178);
  display: block;
}
span.run55 {
  background-color: rgb(205, 255, 178);
  display: block;
}
span.run56 {
  background-color: rgb(207, 255, 178);
  display: block;
}
span.run57 {
  background-color: rgb(210, 255, 178);
  display: block;
}
span.run58 {
  background-color: rgb(212, 255, 178);
  display: block;
}
span.run59 {
  background-color: rgb(215, 255, 178);
  display: block;
}
span.run60 {
  background-color: rgb(219, 255, 178);
  display: block;
}
span.run61 {
  background-color: rgb(221, 255, 178);
  display: block;
}
span.run62 {
  background-color: rgb(224, 255, 178);
  display: block;
}
span.run63 {
  background-color: rgb(226, 255, 178);
  display: block;
}
span.run64 {
  background-color: rgb(229, 255, 178);
  display: block;
}
span.run65 {
  background-color: rgb(233, 255, 178);
  display: block;
}
span.run66 {
  background-color: rgb(235, 255, 178);
  display: block;
}
span.run67 {
  background-color: rgb(238, 255, 178);
  display: block;
}
span.run68 {
  background-color: rgb(240, 255, 178);
  display: block;
}
span.run69 {
  background-color: rgb(243, 255, 178);
  display: block;
}
span.run70 {
  background-color: rgb(247, 255, 178);
  display: block;
}
span.run71 {
  background-color: rgb(249, 255, 178);
  display: block;
}
span.run72 {
  background-color: rgb(252, 255, 178);
  display: block;
}
span.run73 {
  background-color: rgb(255, 255, 178);
  display: block;
}
span.run74 {
  background-color: rgb(255, 252, 178);
  display: block;
}
span.run75 {
  background-color: rgb(255, 248, 178);
  display: block;
}
span.run76 {
  background-color: rgb(255, 246, 178);
  display: block;
}
span.run77 {
  background-color: rgb(255, 243, 178);
  display: block;
}
span.run78 {
  background-color: rgb(255, 240, 178);
  display: block;
}
span.run79 {
  background-color: rgb(255, 238, 178);
  display: block;
}
span.run80 {
  background-color: rgb(255, 234, 178);
  display: block;
}
span.run81 {
  background-color: rgb(255, 232, 178);
  display: block;
}
span.run82 {
  background-color: rgb(255, 229, 178);
  display: block;
}
span.run83 {
  background-color: rgb(255, 226, 178);
  display: block;
}
span.run84 {
  background-color: rgb(255, 224, 178);
  display: block;
}
span.run85 {
  background-color: rgb(255, 220, 178);
  display: block;
}
span.run86 {
  background-color: rgb(255, 218, 178);
  display: block;
}
span.run87 {
  background-color: rgb(255, 215, 178);
  display: block;
}
span.run88 {
  background-color: rgb(255, 212, 178);
  display: block;
}
span.run89 {
  background-color: rgb(255, 210, 178);
  display: block;
}
span.run90 {
  background-color: rgb(255, 206, 178);
  display: block;
}
span.run91 {
  background-color: rgb(255, 204, 178);
  display: block;
}
span.run92 {
  background-color: rgb(255, 201, 178);
  display: block;
}
span.run93 {
  background-color: rgb(255, 198, 178);
  display: block;
}
span.run94 {
  background-color: rgb(255, 196, 178);
  display: block;
}
span.run95 {
  background-color: rgb(255, 192, 178);
  display: block;
}
span.run96 {
  background-color: rgb(255, 189, 178);
  display: block;
}
span.run97 {
  background-color: rgb(255, 187, 178);
  display: block;
}
span.run98 {
  background-color: rgb(255, 184, 178);
  display: block;
}
span.run99 {
  background-color: rgb(255, 182, 178);
  display: block;
}
span.run100 {
  background-color: rgb(255, 178, 178);
  display: block;
}
</style>
    </head>
  <body><h3>C0 code coverage information</h3>
    <p>Generated on Wed Sep 23 21:32:52 -0300 2009 with <a href='http://eigenclass.org/hiki/rcov'>rcov 0.8.1.2</a>
      </p>
    <hr/>
    <pre><span class='marked0'>Code reported as executed by Ruby looks like this...
</span><span class='marked1'>and this: this line is also marked as covered.
</span><span class='inferred0'>Lines considered as run by rcov, but not reported by Ruby, look like this,
</span><span class='inferred1'>and this: these lines were inferred by rcov (using simple heuristics).
</span><span class='uncovered0'>Finally, here&apos;s a line marked as not executed.
</span></pre>                       
<table class='report'><thead><tr><td class='heading'>Name</td>
      <td class='heading'>Total lines</td>
      <td class='heading'>Lines of code</td>
      <td class='heading'>Total coverage</td>
      <td class='heading'>Code coverage</td>
      </tr>
    </thead>
  <tbody><tr class='light'><td><a href='lib-SVG-Graph-Graph_rb.html'>lib/SVG/Graph/Graph.rb</a>
        </td>
      <td class='lines_total'><tt>978</tt>
        </td>
      <td class='lines_code'><tt>644</tt>
        </td>
      <td><table cellspacing='0' align='right' cellpadding='0'><tr><td><tt class='coverage_total'>36.6%</tt>
              &nbsp;</td>
            <td><table class='percent_graph' cellspacing='0' width='100' cellpadding='0'><tr><td class='covered' width='37'/>
                  <td class='uncovered' width='63'/>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      <td><table cellspacing='0' align='right' cellpadding='0'><tr><td><tt class='coverage_code'>13.2%</tt>
              &nbsp;</td>
            <td><table class='percent_graph' cellspacing='0' width='100' cellpadding='0'><tr><td class='covered' width='13'/>
                  <td class='uncovered' width='87'/>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </tbody>
  </table>
<pre><span class="marked1"><a name="line1"></a>  1 begin
</span><span class="marked0"><a name="line2"></a>  2   require 'zlib'
</span><span class="marked1"><a name="line3"></a>  3   @@__have_zlib = true
</span><span class="uncovered0"><a name="line4"></a>  4 rescue
</span><span class="uncovered1"><a name="line5"></a>  5   @@__have_zlib = false
</span><span class="uncovered0"><a name="line6"></a>  6 end
</span><span class="inferred1"><a name="line7"></a>  7 
</span><span class="marked0"><a name="line8"></a>  8 require 'rexml/document'
</span><span class="inferred1"><a name="line9"></a>  9 
</span><span class="marked0"><a name="line10"></a> 10 module SVG
</span><span class="marked1"><a name="line11"></a> 11   module Graph
</span><span class="marked0"><a name="line12"></a> 12     VERSION = '@ANT_VERSION@'
</span><span class="inferred1"><a name="line13"></a> 13 
</span><span class="inferred0"><a name="line14"></a> 14     # === Base object for generating SVG Graphs
</span><span class="inferred1"><a name="line15"></a> 15     # 
</span><span class="inferred0"><a name="line16"></a> 16     # == Synopsis
</span><span class="inferred1"><a name="line17"></a> 17     #
</span><span class="inferred0"><a name="line18"></a> 18     # This class is only used as a superclass of specialized charts.  Do not
</span><span class="inferred1"><a name="line19"></a> 19     # attempt to use this class directly, unless creating a new chart type.
</span><span class="inferred0"><a name="line20"></a> 20     #
</span><span class="inferred1"><a name="line21"></a> 21     # For examples of how to subclass this class, see the existing specific
</span><span class="inferred0"><a name="line22"></a> 22     # subclasses, such as SVG::Graph::Pie.
</span><span class="inferred1"><a name="line23"></a> 23     #
</span><span class="inferred0"><a name="line24"></a> 24     # == Examples
</span><span class="inferred1"><a name="line25"></a> 25     #
</span><span class="inferred0"><a name="line26"></a> 26     # For examples of how to use this package, see either the test files, or
</span><span class="inferred1"><a name="line27"></a> 27     # the documentation for the specific class you want to use.
</span><span class="inferred0"><a name="line28"></a> 28     #
</span><span class="inferred1"><a name="line29"></a> 29     # * file:test/plot.rb
</span><span class="inferred0"><a name="line30"></a> 30     # * file:test/single.rb
</span><span class="inferred1"><a name="line31"></a> 31     # * file:test/test.rb
</span><span class="inferred0"><a name="line32"></a> 32     # * file:test/timeseries.rb
</span><span class="inferred1"><a name="line33"></a> 33     # 
</span><span class="inferred0"><a name="line34"></a> 34     # == Description
</span><span class="inferred1"><a name="line35"></a> 35     # 
</span><span class="inferred0"><a name="line36"></a> 36     # This package should be used as a base for creating SVG graphs.
</span><span class="inferred1"><a name="line37"></a> 37     #
</span><span class="inferred0"><a name="line38"></a> 38     # == Acknowledgements
</span><span class="inferred1"><a name="line39"></a> 39     #
</span><span class="inferred0"><a name="line40"></a> 40     # Leo Lapworth for creating the SVG::TT::Graph package which this Ruby
</span><span class="inferred1"><a name="line41"></a> 41     # port is based on.
</span><span class="inferred0"><a name="line42"></a> 42     #
</span><span class="inferred1"><a name="line43"></a> 43     # Stephen Morgan for creating the TT template and SVG.
</span><span class="inferred0"><a name="line44"></a> 44     # 
</span><span class="inferred1"><a name="line45"></a> 45     # == See
</span><span class="inferred0"><a name="line46"></a> 46     #
</span><span class="inferred1"><a name="line47"></a> 47     # * SVG::Graph::BarHorizontal
</span><span class="inferred0"><a name="line48"></a> 48     # * SVG::Graph::Bar
</span><span class="inferred1"><a name="line49"></a> 49     # * SVG::Graph::Line
</span><span class="inferred0"><a name="line50"></a> 50     # * SVG::Graph::Pie
</span><span class="inferred1"><a name="line51"></a> 51     # * SVG::Graph::Plot
</span><span class="inferred0"><a name="line52"></a> 52     # * SVG::Graph::TimeSeries
</span><span class="inferred1"><a name="line53"></a> 53     #
</span><span class="inferred0"><a name="line54"></a> 54     # == Author
</span><span class="inferred1"><a name="line55"></a> 55     #
</span><span class="inferred0"><a name="line56"></a> 56     # Sean E. Russell &lt;serATgermaneHYPHENsoftwareDOTcom&gt;
</span><span class="inferred1"><a name="line57"></a> 57     #
</span><span class="inferred0"><a name="line58"></a> 58     # Copyright 2004 Sean E. Russell
</span><span class="inferred1"><a name="line59"></a> 59     # This software is available under the Ruby license[LICENSE.txt]
</span><span class="inferred0"><a name="line60"></a> 60     #
</span><span class="marked1"><a name="line61"></a> 61     class Graph
</span><span class="marked0"><a name="line62"></a> 62       include REXML
</span><span class="inferred1"><a name="line63"></a> 63 
</span><span class="inferred0"><a name="line64"></a> 64       # Initialize the graph object with the graph settings.  You won't
</span><span class="inferred1"><a name="line65"></a> 65       # instantiate this class directly; see the subclass for options.
</span><span class="inferred0"><a name="line66"></a> 66       # [width] 500
</span><span class="inferred1"><a name="line67"></a> 67       # [height] 300
</span><span class="inferred0"><a name="line68"></a> 68       # [show_x_guidelines] false
</span><span class="inferred1"><a name="line69"></a> 69       # [show_y_guidelines] true
</span><span class="inferred0"><a name="line70"></a> 70       # [show_data_values] true
</span><span class="inferred1"><a name="line71"></a> 71       # [min_scale_value] 0
</span><span class="inferred0"><a name="line72"></a> 72       # [show_x_labels] true
</span><span class="inferred1"><a name="line73"></a> 73       # [stagger_x_labels] false
</span><span class="inferred0"><a name="line74"></a> 74       # [rotate_x_labels] false
</span><span class="inferred1"><a name="line75"></a> 75       # [step_x_labels] 1
</span><span class="inferred0"><a name="line76"></a> 76       # [step_include_first_x_label] true
</span><span class="inferred1"><a name="line77"></a> 77       # [show_y_labels] true
</span><span class="inferred0"><a name="line78"></a> 78       # [rotate_y_labels] false
</span><span class="inferred1"><a name="line79"></a> 79       # [scale_integers] false
</span><span class="inferred0"><a name="line80"></a> 80       # [show_x_title] false
</span><span class="inferred1"><a name="line81"></a> 81       # [x_title] 'X Field names'
</span><span class="inferred0"><a name="line82"></a> 82       # [show_y_title] false
</span><span class="inferred1"><a name="line83"></a> 83       # [y_title_text_direction] :bt
</span><span class="inferred0"><a name="line84"></a> 84       # [y_title] 'Y Scale'
</span><span class="inferred1"><a name="line85"></a> 85       # [show_graph_title] false
</span><span class="inferred0"><a name="line86"></a> 86       # [graph_title] 'Graph Title'
</span><span class="inferred1"><a name="line87"></a> 87       # [show_graph_subtitle] false
</span><span class="inferred0"><a name="line88"></a> 88       # [graph_subtitle] 'Graph Sub Title'
</span><span class="inferred1"><a name="line89"></a> 89       # [key] true,
</span><span class="inferred0"><a name="line90"></a> 90       # [key_position] :right, # bottom or righ
</span><span class="inferred1"><a name="line91"></a> 91       # [font_size] 12
</span><span class="inferred0"><a name="line92"></a> 92       # [title_font_size] 16
</span><span class="inferred1"><a name="line93"></a> 93       # [subtitle_font_size] 14
</span><span class="inferred0"><a name="line94"></a> 94       # [x_label_font_size] 12
</span><span class="inferred1"><a name="line95"></a> 95       # [x_title_font_size] 14
</span><span class="inferred0"><a name="line96"></a> 96       # [y_label_font_size] 12
</span><span class="inferred1"><a name="line97"></a> 97       # [y_title_font_size] 14
</span><span class="inferred0"><a name="line98"></a> 98       # [key_font_size] 10
</span><span class="inferred1"><a name="line99"></a> 99       # [no_css] false
</span><span class="inferred0"><a name="line100"></a>100       # [add_popups] false
</span><span class="marked1"><a name="line101"></a>101       def initialize( config )
</span><span class="uncovered0"><a name="line102"></a>102         @config = config
</span><span class="uncovered1"><a name="line103"></a>103 
</span><span class="uncovered0"><a name="line104"></a>104         self.top_align = self.top_font = self.right_align = self.right_font = 0
</span><span class="uncovered1"><a name="line105"></a>105 
</span><span class="uncovered0"><a name="line106"></a>106         init_with({
</span><span class="uncovered1"><a name="line107"></a>107           :width                =&gt; 500,
</span><span class="uncovered0"><a name="line108"></a>108           :height                =&gt; 300,
</span><span class="uncovered1"><a name="line109"></a>109           :show_x_guidelines    =&gt; false,
</span><span class="uncovered0"><a name="line110"></a>110           :show_y_guidelines    =&gt; true,
</span><span class="uncovered1"><a name="line111"></a>111           :show_data_values     =&gt; true,
</span><span class="uncovered0"><a name="line112"></a>112 
</span><span class="uncovered1"><a name="line113"></a>113 #          :min_scale_value      =&gt; 0,
</span><span class="uncovered0"><a name="line114"></a>114 
</span><span class="uncovered1"><a name="line115"></a>115           :show_x_labels        =&gt; true,
</span><span class="uncovered0"><a name="line116"></a>116           :stagger_x_labels     =&gt; false,
</span><span class="uncovered1"><a name="line117"></a>117           :rotate_x_labels      =&gt; false,
</span><span class="uncovered0"><a name="line118"></a>118           :step_x_labels        =&gt; 1,
</span><span class="uncovered1"><a name="line119"></a>119           :step_include_first_x_label =&gt; true,
</span><span class="uncovered0"><a name="line120"></a>120 
</span><span class="uncovered1"><a name="line121"></a>121           :show_y_labels        =&gt; true,
</span><span class="uncovered0"><a name="line122"></a>122           :rotate_y_labels      =&gt; false,
</span><span class="uncovered1"><a name="line123"></a>123           :stagger_y_labels     =&gt; false,
</span><span class="uncovered0"><a name="line124"></a>124           :scale_integers       =&gt; false,
</span><span class="uncovered1"><a name="line125"></a>125 
</span><span class="uncovered0"><a name="line126"></a>126           :show_x_title         =&gt; false,
</span><span class="uncovered1"><a name="line127"></a>127           :x_title              =&gt; 'X Field names',
</span><span class="uncovered0"><a name="line128"></a>128 
</span><span class="uncovered1"><a name="line129"></a>129           :show_y_title         =&gt; false,
</span><span class="uncovered0"><a name="line130"></a>130           :y_title_text_direction =&gt; :bt,
</span><span class="uncovered1"><a name="line131"></a>131           :y_title              =&gt; 'Y Scale',
</span><span class="uncovered0"><a name="line132"></a>132 
</span><span class="uncovered1"><a name="line133"></a>133           :show_graph_title      =&gt; false,
</span><span class="uncovered0"><a name="line134"></a>134           :graph_title          =&gt; 'Graph Title',
</span><span class="uncovered1"><a name="line135"></a>135           :show_graph_subtitle  =&gt; false,
</span><span class="uncovered0"><a name="line136"></a>136           :graph_subtitle        =&gt; 'Graph Sub Title',
</span><span class="uncovered1"><a name="line137"></a>137           :key                  =&gt; true, 
</span><span class="uncovered0"><a name="line138"></a>138           :key_position          =&gt; :right, # bottom or right
</span><span class="uncovered1"><a name="line139"></a>139 
</span><span class="uncovered0"><a name="line140"></a>140           :font_size            =&gt;12,
</span><span class="uncovered1"><a name="line141"></a>141           :title_font_size      =&gt;16,
</span><span class="uncovered0"><a name="line142"></a>142           :subtitle_font_size   =&gt;14,
</span><span class="uncovered1"><a name="line143"></a>143           :x_label_font_size    =&gt;12,
</span><span class="uncovered0"><a name="line144"></a>144           :x_title_font_size    =&gt;14,
</span><span class="uncovered1"><a name="line145"></a>145           :y_label_font_size    =&gt;12,
</span><span class="uncovered0"><a name="line146"></a>146           :y_title_font_size    =&gt;14,
</span><span class="uncovered1"><a name="line147"></a>147           :key_font_size        =&gt;10,
</span><span class="uncovered0"><a name="line148"></a>148           
</span><span class="uncovered1"><a name="line149"></a>149           :no_css               =&gt;false,
</span><span class="uncovered0"><a name="line150"></a>150           :add_popups           =&gt;false,
</span><span class="uncovered1"><a name="line151"></a>151         })
</span><span class="uncovered0"><a name="line152"></a>152 
</span><span class="uncovered1"><a name="line153"></a>153 				set_defaults if methods.include? &quot;set_defaults&quot;
</span><span class="uncovered0"><a name="line154"></a>154 
</span><span class="uncovered1"><a name="line155"></a>155         init_with config
</span><span class="uncovered0"><a name="line156"></a>156       end
</span><span class="inferred1"><a name="line157"></a>157 
</span><span class="inferred0"><a name="line158"></a>158       
</span><span class="inferred1"><a name="line159"></a>159       # This method allows you do add data to the graph object.
</span><span class="inferred0"><a name="line160"></a>160       # It can be called several times to add more data sets in.
</span><span class="inferred1"><a name="line161"></a>161       #
</span><span class="inferred0"><a name="line162"></a>162       #   data_sales_02 = [12, 45, 21];
</span><span class="inferred1"><a name="line163"></a>163       #   
</span><span class="inferred0"><a name="line164"></a>164       #   graph.add_data({
</span><span class="inferred1"><a name="line165"></a>165       #     :data =&gt; data_sales_02,
</span><span class="inferred0"><a name="line166"></a>166       #     :title =&gt; 'Sales 2002'
</span><span class="inferred1"><a name="line167"></a>167       #   })
</span><span class="marked0"><a name="line168"></a>168       def add_data conf
</span><span class="uncovered1"><a name="line169"></a>169         @data = [] unless defined? @data
</span><span class="uncovered0"><a name="line170"></a>170 
</span><span class="uncovered1"><a name="line171"></a>171         if conf[:data] and conf[:data].kind_of? Array
</span><span class="uncovered0"><a name="line172"></a>172           @data &lt;&lt; conf
</span><span class="uncovered1"><a name="line173"></a>173         else
</span><span class="uncovered0"><a name="line174"></a>174           raise &quot;No data provided by #{conf.inspect}&quot;
</span><span class="uncovered1"><a name="line175"></a>175         end
</span><span class="uncovered0"><a name="line176"></a>176       end
</span><span class="inferred1"><a name="line177"></a>177 
</span><span class="inferred0"><a name="line178"></a>178 
</span><span class="inferred1"><a name="line179"></a>179       # This method removes all data from the object so that you can
</span><span class="inferred0"><a name="line180"></a>180       # reuse it to create a new graph but with the same config options.
</span><span class="inferred1"><a name="line181"></a>181       #
</span><span class="inferred0"><a name="line182"></a>182       #   graph.clear_data
</span><span class="marked1"><a name="line183"></a>183       def clear_data 
</span><span class="uncovered0"><a name="line184"></a>184         @data = []
</span><span class="uncovered1"><a name="line185"></a>185       end
</span><span class="inferred0"><a name="line186"></a>186 
</span><span class="inferred1"><a name="line187"></a>187 
</span><span class="inferred0"><a name="line188"></a>188       # This method processes the template with the data and
</span><span class="inferred1"><a name="line189"></a>189       # config which has been set and returns the resulting SVG.
</span><span class="inferred0"><a name="line190"></a>190       #
</span><span class="inferred1"><a name="line191"></a>191       # This method will croak unless at least one data set has
</span><span class="inferred0"><a name="line192"></a>192       # been added to the graph object.
</span><span class="inferred1"><a name="line193"></a>193       #
</span><span class="inferred0"><a name="line194"></a>194       #   print graph.burn
</span><span class="marked1"><a name="line195"></a>195       def burn
</span><span class="uncovered0"><a name="line196"></a>196         raise &quot;No data available&quot; unless @data.size &gt; 0
</span><span class="uncovered1"><a name="line197"></a>197         
</span><span class="uncovered0"><a name="line198"></a>198         calculations if methods.include? 'calculations'
</span><span class="uncovered1"><a name="line199"></a>199 
</span><span class="uncovered0"><a name="line200"></a>200         start_svg
</span><span class="uncovered1"><a name="line201"></a>201         calculate_graph_dimensions
</span><span class="uncovered0"><a name="line202"></a>202         @foreground = Element.new( &quot;g&quot; )
</span><span class="uncovered1"><a name="line203"></a>203         draw_graph
</span><span class="uncovered0"><a name="line204"></a>204         draw_titles
</span><span class="uncovered1"><a name="line205"></a>205         draw_legend
</span><span class="uncovered0"><a name="line206"></a>206         draw_data
</span><span class="uncovered1"><a name="line207"></a>207         @graph.add_element( @foreground )
</span><span class="uncovered0"><a name="line208"></a>208         style
</span><span class="uncovered1"><a name="line209"></a>209 
</span><span class="uncovered0"><a name="line210"></a>210         data = &quot;&quot;
</span><span class="uncovered1"><a name="line211"></a>211         @doc.write( data, 0 )
</span><span class="uncovered0"><a name="line212"></a>212 
</span><span class="uncovered1"><a name="line213"></a>213         if @config[:compress]
</span><span class="uncovered0"><a name="line214"></a>214           if @@__have_zlib
</span><span class="uncovered1"><a name="line215"></a>215             inp, out = IO.pipe
</span><span class="uncovered0"><a name="line216"></a>216             gz = Zlib::GzipWriter.new( out )
</span><span class="uncovered1"><a name="line217"></a>217             gz.write data
</span><span class="uncovered0"><a name="line218"></a>218             gz.close
</span><span class="uncovered1"><a name="line219"></a>219             data = inp.read
</span><span class="uncovered0"><a name="line220"></a>220           else
</span><span class="uncovered1"><a name="line221"></a>221             data &lt;&lt; &quot;&lt;!-- Ruby Zlib not available for SVGZ --&gt;&quot;;
</span><span class="uncovered0"><a name="line222"></a>222           end
</span><span class="uncovered1"><a name="line223"></a>223         end
</span><span class="uncovered0"><a name="line224"></a>224         
</span><span class="uncovered1"><a name="line225"></a>225         return data
</span><span class="uncovered0"><a name="line226"></a>226       end
</span><span class="inferred1"><a name="line227"></a>227 
</span><span class="inferred0"><a name="line228"></a>228 
</span><span class="inferred1"><a name="line229"></a>229       #   Set the height of the graph box, this is the total height
</span><span class="inferred0"><a name="line230"></a>230       #   of the SVG box created - not the graph it self which auto
</span><span class="inferred1"><a name="line231"></a>231       #   scales to fix the space.
</span><span class="marked0"><a name="line232"></a>232       attr_accessor :height
</span><span class="inferred1"><a name="line233"></a>233       #   Set the width of the graph box, this is the total width
</span><span class="inferred0"><a name="line234"></a>234       #   of the SVG box created - not the graph it self which auto
</span><span class="inferred1"><a name="line235"></a>235       #   scales to fix the space.
</span><span class="marked0"><a name="line236"></a>236       attr_accessor :width
</span><span class="inferred1"><a name="line237"></a>237       #   Set the path to an external stylesheet, set to '' if
</span><span class="inferred0"><a name="line238"></a>238       #   you want to revert back to using the defaut internal version.
</span><span class="inferred1"><a name="line239"></a>239       #
</span><span class="inferred0"><a name="line240"></a>240       #   To create an external stylesheet create a graph using the
</span><span class="inferred1"><a name="line241"></a>241       #   default internal version and copy the stylesheet section to
</span><span class="inferred0"><a name="line242"></a>242       #   an external file and edit from there.
</span><span class="marked1"><a name="line243"></a>243       attr_accessor :style_sheet
</span><span class="inferred0"><a name="line244"></a>244       #   (Bool) Show the value of each element of data on the graph
</span><span class="marked1"><a name="line245"></a>245       attr_accessor :show_data_values
</span><span class="inferred0"><a name="line246"></a>246       #   The point at which the Y axis starts, defaults to '0',
</span><span class="inferred1"><a name="line247"></a>247       #   if set to nil it will default to the minimum data value.
</span><span class="marked0"><a name="line248"></a>248       attr_accessor :min_scale_value
</span><span class="inferred1"><a name="line249"></a>249       #   Whether to show labels on the X axis or not, defaults
</span><span class="inferred0"><a name="line250"></a>250       #   to true, set to false if you want to turn them off.
</span><span class="marked1"><a name="line251"></a>251       attr_accessor :show_x_labels
</span><span class="inferred0"><a name="line252"></a>252       #   This puts the X labels at alternative levels so if they
</span><span class="inferred1"><a name="line253"></a>253       #   are long field names they will not overlap so easily.
</span><span class="inferred0"><a name="line254"></a>254       #   Default it false, to turn on set to true.
</span><span class="marked1"><a name="line255"></a>255       attr_accessor :stagger_x_labels
</span><span class="inferred0"><a name="line256"></a>256       #   This puts the Y labels at alternative levels so if they
</span><span class="inferred1"><a name="line257"></a>257       #   are long field names they will not overlap so easily.
</span><span class="inferred0"><a name="line258"></a>258       #   Default it false, to turn on set to true.
</span><span class="marked1"><a name="line259"></a>259       attr_accessor :stagger_y_labels
</span><span class="inferred0"><a name="line260"></a>260       #   This turns the X axis labels by 90 degrees.
</span><span class="inferred1"><a name="line261"></a>261       #   Default it false, to turn on set to true.
</span><span class="marked0"><a name="line262"></a>262       attr_accessor :rotate_x_labels
</span><span class="inferred1"><a name="line263"></a>263       #   This turns the Y axis labels by 90 degrees.
</span><span class="inferred0"><a name="line264"></a>264       #   Default it false, to turn on set to true.
</span><span class="marked1"><a name="line265"></a>265       attr_accessor :rotate_y_labels
</span><span class="inferred0"><a name="line266"></a>266       #   How many &quot;steps&quot; to use between displayed X axis labels,
</span><span class="inferred1"><a name="line267"></a>267       #   a step of one means display every label, a step of two results
</span><span class="inferred0"><a name="line268"></a>268       #   in every other label being displayed (label &lt;gap&gt; label &lt;gap&gt; label),
</span><span class="inferred1"><a name="line269"></a>269       #   a step of three results in every third label being displayed
</span><span class="inferred0"><a name="line270"></a>270       #   (label &lt;gap&gt; &lt;gap&gt; label &lt;gap&gt; &lt;gap&gt; label) and so on.
</span><span class="marked1"><a name="line271"></a>271       attr_accessor :step_x_labels
</span><span class="inferred0"><a name="line272"></a>272       #   Whether to (when taking &quot;steps&quot; between X axis labels) step from 
</span><span class="inferred1"><a name="line273"></a>273       #   the first label (i.e. always include the first label) or step from
</span><span class="inferred0"><a name="line274"></a>274       #   the X axis origin (i.e. start with a gap if step_x_labels is greater
</span><span class="inferred1"><a name="line275"></a>275       #   than one).
</span><span class="marked0"><a name="line276"></a>276       attr_accessor :step_include_first_x_label
</span><span class="inferred1"><a name="line277"></a>277       #   Whether to show labels on the Y axis or not, defaults
</span><span class="inferred0"><a name="line278"></a>278       #   to true, set to false if you want to turn them off.
</span><span class="marked1"><a name="line279"></a>279       attr_accessor :show_y_labels
</span><span class="inferred0"><a name="line280"></a>280       #   Ensures only whole numbers are used as the scale divisions.
</span><span class="inferred1"><a name="line281"></a>281       #   Default it false, to turn on set to true. This has no effect if 
</span><span class="inferred0"><a name="line282"></a>282       #   scale divisions are less than 1.
</span><span class="marked1"><a name="line283"></a>283       attr_accessor :scale_integers
</span><span class="inferred0"><a name="line284"></a>284       #   This defines the gap between markers on the Y axis,
</span><span class="inferred1"><a name="line285"></a>285       #   default is a 10th of the max_value, e.g. you will have
</span><span class="inferred0"><a name="line286"></a>286       #   10 markers on the Y axis. NOTE: do not set this too
</span><span class="inferred1"><a name="line287"></a>287       #   low - you are limited to 999 markers, after that the
</span><span class="inferred0"><a name="line288"></a>288       #   graph won't generate.
</span><span class="marked1"><a name="line289"></a>289       attr_accessor :scale_divisions
</span><span class="inferred0"><a name="line290"></a>290       #   Whether to show the title under the X axis labels,
</span><span class="inferred1"><a name="line291"></a>291       #   default is false, set to true to show.
</span><span class="marked0"><a name="line292"></a>292       attr_accessor :show_x_title
</span><span class="inferred1"><a name="line293"></a>293       #   What the title under X axis should be, e.g. 'Months'.
</span><span class="marked0"><a name="line294"></a>294       attr_accessor :x_title
</span><span class="inferred1"><a name="line295"></a>295       #   Whether to show the title under the Y axis labels,
</span><span class="inferred0"><a name="line296"></a>296       #   default is false, set to true to show.
</span><span class="marked1"><a name="line297"></a>297       attr_accessor :show_y_title
</span><span class="inferred0"><a name="line298"></a>298       #   Aligns writing mode for Y axis label. 
</span><span class="inferred1"><a name="line299"></a>299       #   Defaults to :bt (Bottom to Top).
</span><span class="inferred0"><a name="line300"></a>300       #   Change to :tb (Top to Bottom) to reverse.
</span><span class="marked1"><a name="line301"></a>301       attr_accessor :y_title_text_direction
</span><span class="inferred0"><a name="line302"></a>302       #   What the title under Y axis should be, e.g. 'Sales in thousands'.
</span><span class="marked1"><a name="line303"></a>303       attr_accessor :y_title
</span><span class="inferred0"><a name="line304"></a>304       #   Whether to show a title on the graph, defaults
</span><span class="inferred1"><a name="line305"></a>305       #   to false, set to true to show.
</span><span class="marked0"><a name="line306"></a>306       attr_accessor :show_graph_title
</span><span class="inferred1"><a name="line307"></a>307       #   What the title on the graph should be.
</span><span class="marked0"><a name="line308"></a>308       attr_accessor :graph_title
</span><span class="inferred1"><a name="line309"></a>309       #   Whether to show a subtitle on the graph, defaults
</span><span class="inferred0"><a name="line310"></a>310       #   to false, set to true to show.
</span><span class="marked1"><a name="line311"></a>311       attr_accessor :show_graph_subtitle
</span><span class="inferred0"><a name="line312"></a>312       #   What the subtitle on the graph should be.
</span><span class="marked1"><a name="line313"></a>313       attr_accessor :graph_subtitle
</span><span class="inferred0"><a name="line314"></a>314       #   Whether to show a key, defaults to false, set to
</span><span class="inferred1"><a name="line315"></a>315       #   true if you want to show it.
</span><span class="marked0"><a name="line316"></a>316       attr_accessor :key
</span><span class="inferred1"><a name="line317"></a>317       #   Where the key should be positioned, defaults to
</span><span class="inferred0"><a name="line318"></a>318       #   :right, set to :bottom if you want to move it.
</span><span class="marked1"><a name="line319"></a>319       attr_accessor :key_position
</span><span class="inferred0"><a name="line320"></a>320       # Set the font size (in points) of the data point labels
</span><span class="marked1"><a name="line321"></a>321       attr_accessor :font_size
</span><span class="inferred0"><a name="line322"></a>322       # Set the font size of the X axis labels
</span><span class="marked1"><a name="line323"></a>323       attr_accessor :x_label_font_size
</span><span class="inferred0"><a name="line324"></a>324       # Set the font size of the X axis title
</span><span class="marked1"><a name="line325"></a>325       attr_accessor :x_title_font_size
</span><span class="inferred0"><a name="line326"></a>326       # Set the font size of the Y axis labels
</span><span class="marked1"><a name="line327"></a>327       attr_accessor :y_label_font_size
</span><span class="inferred0"><a name="line328"></a>328       # Set the font size of the Y axis title
</span><span class="marked1"><a name="line329"></a>329       attr_accessor :y_title_font_size
</span><span class="inferred0"><a name="line330"></a>330       # Set the title font size
</span><span class="marked1"><a name="line331"></a>331       attr_accessor :title_font_size
</span><span class="inferred0"><a name="line332"></a>332       # Set the subtitle font size
</span><span class="marked1"><a name="line333"></a>333       attr_accessor :subtitle_font_size
</span><span class="inferred0"><a name="line334"></a>334       # Set the key font size
</span><span class="marked1"><a name="line335"></a>335       attr_accessor :key_font_size
</span><span class="inferred0"><a name="line336"></a>336       # Show guidelines for the X axis
</span><span class="marked1"><a name="line337"></a>337       attr_accessor :show_x_guidelines
</span><span class="inferred0"><a name="line338"></a>338       # Show guidelines for the Y axis
</span><span class="marked1"><a name="line339"></a>339       attr_accessor :show_y_guidelines
</span><span class="inferred0"><a name="line340"></a>340       # Do not use CSS if set to true.  Many SVG viewers do not support CSS, but
</span><span class="inferred1"><a name="line341"></a>341       # not using CSS can result in larger SVGs as well as making it impossible to
</span><span class="inferred0"><a name="line342"></a>342       # change colors after the chart is generated.  Defaults to false.
</span><span class="marked1"><a name="line343"></a>343       attr_accessor :no_css
</span><span class="inferred0"><a name="line344"></a>344       # Add popups for the data points on some graphs
</span><span class="marked1"><a name="line345"></a>345       attr_accessor :add_popups
</span><span class="inferred0"><a name="line346"></a>346 
</span><span class="inferred1"><a name="line347"></a>347 
</span><span class="marked0"><a name="line348"></a>348       protected
</span><span class="inferred1"><a name="line349"></a>349 
</span><span class="marked0"><a name="line350"></a>350       def sort( *arrys )
</span><span class="uncovered1"><a name="line351"></a>351         sort_multiple( arrys )
</span><span class="uncovered0"><a name="line352"></a>352       end
</span><span class="inferred1"><a name="line353"></a>353 
</span><span class="inferred0"><a name="line354"></a>354       # Overwrite configuration options with supplied options.  Used
</span><span class="inferred1"><a name="line355"></a>355       # by subclasses.
</span><span class="marked0"><a name="line356"></a>356       def init_with config
</span><span class="uncovered1"><a name="line357"></a>357         config.each { |key, value|
</span><span class="uncovered0"><a name="line358"></a>358           self.send( key.to_s+&quot;=&quot;, value ) if methods.include? key.to_s
</span><span class="uncovered1"><a name="line359"></a>359         }
</span><span class="uncovered0"><a name="line360"></a>360       end
</span><span class="inferred1"><a name="line361"></a>361 
</span><span class="marked0"><a name="line362"></a>362       attr_accessor :top_align, :top_font, :right_align, :right_font
</span><span class="inferred1"><a name="line363"></a>363 
</span><span class="marked0"><a name="line364"></a>364       KEY_BOX_SIZE = 12
</span><span class="inferred1"><a name="line365"></a>365 
</span><span class="inferred0"><a name="line366"></a>366       # Override this (and call super) to change the margin to the left
</span><span class="inferred1"><a name="line367"></a>367       # of the plot area.  Results in @border_left being set.
</span><span class="marked0"><a name="line368"></a>368       def calculate_left_margin
</span><span class="uncovered1"><a name="line369"></a>369         @border_left = 7
</span><span class="uncovered0"><a name="line370"></a>370         # Check for Y labels
</span><span class="uncovered1"><a name="line371"></a>371         max_y_label_height_px = rotate_y_labels ? 
</span><span class="uncovered0"><a name="line372"></a>372           y_label_font_size :
</span><span class="uncovered1"><a name="line373"></a>373           get_y_labels.max{|a,b| 
</span><span class="uncovered0"><a name="line374"></a>374             a.to_s.length&lt;=&gt;b.to_s.length
</span><span class="uncovered1"><a name="line375"></a>375           }.to_s.length * y_label_font_size * 0.6
</span><span class="uncovered0"><a name="line376"></a>376         @border_left += max_y_label_height_px if show_y_labels
</span><span class="uncovered1"><a name="line377"></a>377         @border_left += max_y_label_height_px + 10 if stagger_y_labels
</span><span class="uncovered0"><a name="line378"></a>378         @border_left += y_title_font_size + 5 if show_y_title
</span><span class="uncovered1"><a name="line379"></a>379       end
</span><span class="inferred0"><a name="line380"></a>380 
</span><span class="inferred1"><a name="line381"></a>381 
</span><span class="inferred0"><a name="line382"></a>382       # Calculates the width of the widest Y label.  This will be the
</span><span class="inferred1"><a name="line383"></a>383       # character height if the Y labels are rotated
</span><span class="marked0"><a name="line384"></a>384       def max_y_label_width_px
</span><span class="uncovered1"><a name="line385"></a>385         return font_size if rotate_y_labels
</span><span class="uncovered0"><a name="line386"></a>386       end
</span><span class="inferred1"><a name="line387"></a>387 
</span><span class="inferred0"><a name="line388"></a>388 
</span><span class="inferred1"><a name="line389"></a>389       # Override this (and call super) to change the margin to the right
</span><span class="inferred0"><a name="line390"></a>390       # of the plot area.  Results in @border_right being set.
</span><span class="marked1"><a name="line391"></a>391       def calculate_right_margin
</span><span class="uncovered0"><a name="line392"></a>392         @border_right = 7
</span><span class="uncovered1"><a name="line393"></a>393         if key and key_position == :right
</span><span class="uncovered0"><a name="line394"></a>394           val = keys.max { |a,b| a.length &lt;=&gt; b.length }
</span><span class="uncovered1"><a name="line395"></a>395           @border_right += val.length * key_font_size * 0.6 
</span><span class="uncovered0"><a name="line396"></a>396           @border_right += KEY_BOX_SIZE
</span><span class="uncovered1"><a name="line397"></a>397           @border_right += 10    # Some padding around the box
</span><span class="uncovered0"><a name="line398"></a>398         end
</span><span class="uncovered1"><a name="line399"></a>399       end
</span><span class="inferred0"><a name="line400"></a>400 
</span><span class="inferred1"><a name="line401"></a>401 
</span><span class="inferred0"><a name="line402"></a>402       # Override this (and call super) to change the margin to the top
</span><span class="inferred1"><a name="line403"></a>403       # of the plot area.  Results in @border_top being set.
</span><span class="marked0"><a name="line404"></a>404       def calculate_top_margin
</span><span class="uncovered1"><a name="line405"></a>405         @border_top = 5
</span><span class="uncovered0"><a name="line406"></a>406         @border_top += title_font_size if show_graph_title
</span><span class="uncovered1"><a name="line407"></a>407         @border_top += 5
</span><span class="uncovered0"><a name="line408"></a>408         @border_top += subtitle_font_size if show_graph_subtitle
</span><span class="uncovered1"><a name="line409"></a>409       end
</span><span class="inferred0"><a name="line410"></a>410 
</span><span class="inferred1"><a name="line411"></a>411 
</span><span class="inferred0"><a name="line412"></a>412       # Adds pop-up point information to a graph.
</span><span class="marked1"><a name="line413"></a>413       def add_popup( x, y, label )
</span><span class="uncovered0"><a name="line414"></a>414         txt_width = label.length * font_size * 0.6 + 10
</span><span class="uncovered1"><a name="line415"></a>415         tx = (x+txt_width &gt; width ? x-5 : x+5)
</span><span class="uncovered0"><a name="line416"></a>416         t = @foreground.add_element( &quot;text&quot;, {
</span><span class="uncovered1"><a name="line417"></a>417           &quot;x&quot; =&gt; tx.to_s,
</span><span class="uncovered0"><a name="line418"></a>418           &quot;y&quot; =&gt; (y - font_size).to_s,
</span><span class="uncovered1"><a name="line419"></a>419           &quot;visibility&quot; =&gt; &quot;hidden&quot;,
</span><span class="uncovered0"><a name="line420"></a>420         })
</span><span class="uncovered1"><a name="line421"></a>421         t.attributes[&quot;style&quot;] = &quot;fill: #000; &quot;+
</span><span class="uncovered0"><a name="line422"></a>422           (x+txt_width &gt; width ? &quot;text-anchor: end;&quot; : &quot;text-anchor: start;&quot;)
</span><span class="uncovered1"><a name="line423"></a>423         t.text = label.to_s
</span><span class="uncovered0"><a name="line424"></a>424         t.attributes[&quot;id&quot;] = t.object_id.to_s
</span><span class="uncovered1"><a name="line425"></a>425 
</span><span class="uncovered0"><a name="line426"></a>426         @foreground.add_element( &quot;circle&quot;, {
</span><span class="uncovered1"><a name="line427"></a>427           &quot;cx&quot; =&gt; x.to_s,
</span><span class="uncovered0"><a name="line428"></a>428           &quot;cy&quot; =&gt; y.to_s,
</span><span class="uncovered1"><a name="line429"></a>429           &quot;r&quot; =&gt; &quot;10&quot;,
</span><span class="uncovered0"><a name="line430"></a>430           &quot;style&quot; =&gt; &quot;opacity: 0&quot;,
</span><span class="uncovered1"><a name="line431"></a>431           &quot;onmouseover&quot; =&gt; 
</span><span class="uncovered0"><a name="line432"></a>432             &quot;document.getElementById(#{t.object_id}).setAttribute('visibility', 'visible' )&quot;,
</span><span class="uncovered1"><a name="line433"></a>433           &quot;onmouseout&quot; =&gt; 
</span><span class="uncovered0"><a name="line434"></a>434             &quot;document.getElementById(#{t.object_id}).setAttribute('visibility', 'hidden' )&quot;,
</span><span class="uncovered1"><a name="line435"></a>435         })
</span><span class="uncovered0"><a name="line436"></a>436 
</span><span class="uncovered1"><a name="line437"></a>437       end
</span><span class="inferred0"><a name="line438"></a>438 
</span><span class="inferred1"><a name="line439"></a>439       
</span><span class="inferred0"><a name="line440"></a>440       # Override this (and call super) to change the margin to the bottom
</span><span class="inferred1"><a name="line441"></a>441       # of the plot area.  Results in @border_bottom being set.
</span><span class="marked0"><a name="line442"></a>442       def calculate_bottom_margin
</span><span class="uncovered1"><a name="line443"></a>443         @border_bottom = 7
</span><span class="uncovered0"><a name="line444"></a>444         if key and key_position == :bottom
</span><span class="uncovered1"><a name="line445"></a>445           @border_bottom += @data.size * (font_size + 5)
</span><span class="uncovered0"><a name="line446"></a>446           @border_bottom += 10
</span><span class="uncovered1"><a name="line447"></a>447         end
</span><span class="uncovered0"><a name="line448"></a>448         if show_x_labels
</span><span class="uncovered1"><a name="line449"></a>449 		  max_x_label_height_px = (not rotate_x_labels) ? 
</span><span class="uncovered0"><a name="line450"></a>450             x_label_font_size :
</span><span class="uncovered1"><a name="line451"></a>451             get_x_labels.max{|a,b| 
</span><span class="uncovered0"><a name="line452"></a>452               a.to_s.length&lt;=&gt;b.to_s.length
</span><span class="uncovered1"><a name="line453"></a>453             }.to_s.length * x_label_font_size * 0.6
</span><span class="uncovered0"><a name="line454"></a>454           @border_bottom += max_x_label_height_px
</span><span class="uncovered1"><a name="line455"></a>455           @border_bottom += max_x_label_height_px + 10 if stagger_x_labels
</span><span class="uncovered0"><a name="line456"></a>456         end
</span><span class="uncovered1"><a name="line457"></a>457         @border_bottom += x_title_font_size + 5 if show_x_title
</span><span class="uncovered0"><a name="line458"></a>458       end
</span><span class="inferred1"><a name="line459"></a>459 
</span><span class="inferred0"><a name="line460"></a>460 
</span><span class="inferred1"><a name="line461"></a>461       # Draws the background, axis, and labels.
</span><span class="marked0"><a name="line462"></a>462       def draw_graph
</span><span class="uncovered1"><a name="line463"></a>463         @graph = @root.add_element( &quot;g&quot;, {
</span><span class="uncovered0"><a name="line464"></a>464           &quot;transform&quot; =&gt; &quot;translate( #@border_left #@border_top )&quot;
</span><span class="uncovered1"><a name="line465"></a>465         })
</span><span class="uncovered0"><a name="line466"></a>466 
</span><span class="uncovered1"><a name="line467"></a>467         # Background
</span><span class="uncovered0"><a name="line468"></a>468         @graph.add_element( &quot;rect&quot;, {
</span><span class="uncovered1"><a name="line469"></a>469           &quot;x&quot; =&gt; &quot;0&quot;,
</span><span class="uncovered0"><a name="line470"></a>470           &quot;y&quot; =&gt; &quot;0&quot;,
</span><span class="uncovered1"><a name="line471"></a>471           &quot;width&quot; =&gt; @graph_width.to_s,
</span><span class="uncovered0"><a name="line472"></a>472           &quot;height&quot; =&gt; @graph_height.to_s,
</span><span class="uncovered1"><a name="line473"></a>473           &quot;class&quot; =&gt; &quot;graphBackground&quot;
</span><span class="uncovered0"><a name="line474"></a>474         })
</span><span class="uncovered1"><a name="line475"></a>475 
</span><span class="uncovered0"><a name="line476"></a>476         # Axis
</span><span class="uncovered1"><a name="line477"></a>477         @graph.add_element( &quot;path&quot;, {
</span><span class="uncovered0"><a name="line478"></a>478           &quot;d&quot; =&gt; &quot;M 0 0 v#@graph_height&quot;,
</span><span class="uncovered1"><a name="line479"></a>479           &quot;class&quot; =&gt; &quot;axis&quot;,
</span><span class="uncovered0"><a name="line480"></a>480           &quot;id&quot; =&gt; &quot;xAxis&quot;
</span><span class="uncovered1"><a name="line481"></a>481         })
</span><span class="uncovered0"><a name="line482"></a>482         @graph.add_element( &quot;path&quot;, {
</span><span class="uncovered1"><a name="line483"></a>483           &quot;d&quot; =&gt; &quot;M 0 #@graph_height h#@graph_width&quot;,
</span><span class="uncovered0"><a name="line484"></a>484           &quot;class&quot; =&gt; &quot;axis&quot;,
</span><span class="uncovered1"><a name="line485"></a>485           &quot;id&quot; =&gt; &quot;yAxis&quot;
</span><span class="uncovered0"><a name="line486"></a>486         })
</span><span class="uncovered1"><a name="line487"></a>487 
</span><span class="uncovered0"><a name="line488"></a>488         draw_x_labels
</span><span class="uncovered1"><a name="line489"></a>489         draw_y_labels
</span><span class="uncovered0"><a name="line490"></a>490       end
</span><span class="inferred1"><a name="line491"></a>491 
</span><span class="inferred0"><a name="line492"></a>492 
</span><span class="inferred1"><a name="line493"></a>493       # Where in the X area the label is drawn
</span><span class="inferred0"><a name="line494"></a>494       # Centered in the field, should be width/2.  Start, 0.
</span><span class="marked1"><a name="line495"></a>495       def x_label_offset( width )
</span><span class="uncovered0"><a name="line496"></a>496         0
</span><span class="uncovered1"><a name="line497"></a>497       end
</span><span class="inferred0"><a name="line498"></a>498 
</span><span class="marked1"><a name="line499"></a>499       def make_datapoint_text( x, y, value, style=&quot;&quot; )
</span><span class="uncovered0"><a name="line500"></a>500         if show_data_values
</span><span class="uncovered1"><a name="line501"></a>501           @foreground.add_element( &quot;text&quot;, {
</span><span class="uncovered0"><a name="line502"></a>502             &quot;x&quot; =&gt; x.to_s,
</span><span class="uncovered1"><a name="line503"></a>503             &quot;y&quot; =&gt; y.to_s,
</span><span class="uncovered0"><a name="line504"></a>504             &quot;class&quot; =&gt; &quot;dataPointLabel&quot;,
</span><span class="uncovered1"><a name="line505"></a>505             &quot;style&quot; =&gt; &quot;#{style} stroke: #fff; stroke-width: 2;&quot;
</span><span class="uncovered0"><a name="line506"></a>506           }).text = value.to_s
</span><span class="uncovered1"><a name="line507"></a>507           text = @foreground.add_element( &quot;text&quot;, {
</span><span class="uncovered0"><a name="line508"></a>508             &quot;x&quot; =&gt; x.to_s,
</span><span class="uncovered1"><a name="line509"></a>509             &quot;y&quot; =&gt; y.to_s,
</span><span class="uncovered0"><a name="line510"></a>510             &quot;class&quot; =&gt; &quot;dataPointLabel&quot;
</span><span class="uncovered1"><a name="line511"></a>511           })
</span><span class="uncovered0"><a name="line512"></a>512           text.text = value.to_s
</span><span class="uncovered1"><a name="line513"></a>513           text.attributes[&quot;style&quot;] = style if style.length &gt; 0
</span><span class="uncovered0"><a name="line514"></a>514         end
</span><span class="uncovered1"><a name="line515"></a>515       end
</span><span class="inferred0"><a name="line516"></a>516 
</span><span class="inferred1"><a name="line517"></a>517 
</span><span class="inferred0"><a name="line518"></a>518       # Draws the X axis labels
</span><span class="marked1"><a name="line519"></a>519       def draw_x_labels
</span><span class="uncovered0"><a name="line520"></a>520         stagger = x_label_font_size + 5
</span><span class="uncovered1"><a name="line521"></a>521         if show_x_labels
</span><span class="uncovered0"><a name="line522"></a>522           label_width = field_width
</span><span class="uncovered1"><a name="line523"></a>523 
</span><span class="uncovered0"><a name="line524"></a>524           count = 0
</span><span class="uncovered1"><a name="line525"></a>525           for label in get_x_labels
</span><span class="uncovered0"><a name="line526"></a>526             if step_include_first_x_label == true then
</span><span class="uncovered1"><a name="line527"></a>527               step = count % step_x_labels
</span><span class="uncovered0"><a name="line528"></a>528             else
</span><span class="uncovered1"><a name="line529"></a>529               step = (count + 1) % step_x_labels
</span><span class="uncovered0"><a name="line530"></a>530             end
</span><span class="uncovered1"><a name="line531"></a>531 
</span><span class="uncovered0"><a name="line532"></a>532             if step == 0 then
</span><span class="uncovered1"><a name="line533"></a>533               text = @graph.add_element( &quot;text&quot; )
</span><span class="uncovered0"><a name="line534"></a>534               text.attributes[&quot;class&quot;] = &quot;xAxisLabels&quot;
</span><span class="uncovered1"><a name="line535"></a>535               text.text = label.to_s
</span><span class="uncovered0"><a name="line536"></a>536 
</span><span class="uncovered1"><a name="line537"></a>537               x = count * label_width + x_label_offset( label_width )
</span><span class="uncovered0"><a name="line538"></a>538               y = @graph_height + x_label_font_size + 3
</span><span class="uncovered1"><a name="line539"></a>539               t = 0 - (font_size / 2)
</span><span class="uncovered0"><a name="line540"></a>540 
</span><span class="uncovered1"><a name="line541"></a>541               if stagger_x_labels and count % 2 == 1
</span><span class="uncovered0"><a name="line542"></a>542                 y += stagger
</span><span class="uncovered1"><a name="line543"></a>543                 @graph.add_element( &quot;path&quot;, {
</span><span class="uncovered0"><a name="line544"></a>544                   &quot;d&quot; =&gt; &quot;M#{x} #@graph_height v#{stagger}&quot;,
</span><span class="uncovered1"><a name="line545"></a>545                   &quot;class&quot; =&gt; &quot;staggerGuideLine&quot;
</span><span class="uncovered0"><a name="line546"></a>546                 })
</span><span class="uncovered1"><a name="line547"></a>547               end
</span><span class="uncovered0"><a name="line548"></a>548 
</span><span class="uncovered1"><a name="line549"></a>549               text.attributes[&quot;x&quot;] = x.to_s
</span><span class="uncovered0"><a name="line550"></a>550               text.attributes[&quot;y&quot;] = y.to_s
</span><span class="uncovered1"><a name="line551"></a>551               if rotate_x_labels
</span><span class="uncovered0"><a name="line552"></a>552                 text.attributes[&quot;transform&quot;] = 
</span><span class="uncovered1"><a name="line553"></a>553                   &quot;rotate( 90 #{x} #{y-x_label_font_size} )&quot;+
</span><span class="uncovered0"><a name="line554"></a>554                   &quot; translate( 0 -#{x_label_font_size/4} )&quot;
</span><span class="uncovered1"><a name="line555"></a>555                 text.attributes[&quot;style&quot;] = &quot;text-anchor: start&quot;
</span><span class="uncovered0"><a name="line556"></a>556               else
</span><span class="uncovered1"><a name="line557"></a>557                 text.attributes[&quot;style&quot;] = &quot;text-anchor: middle&quot;
</span><span class="uncovered0"><a name="line558"></a>558               end
</span><span class="uncovered1"><a name="line559"></a>559             end
</span><span class="uncovered0"><a name="line560"></a>560 
</span><span class="uncovered1"><a name="line561"></a>561             draw_x_guidelines( label_width, count ) if show_x_guidelines
</span><span class="uncovered0"><a name="line562"></a>562             count += 1
</span><span class="uncovered1"><a name="line563"></a>563           end
</span><span class="uncovered0"><a name="line564"></a>564         end
</span><span class="uncovered1"><a name="line565"></a>565       end
</span><span class="inferred0"><a name="line566"></a>566 
</span><span class="inferred1"><a name="line567"></a>567 
</span><span class="inferred0"><a name="line568"></a>568       # Where in the Y area the label is drawn
</span><span class="inferred1"><a name="line569"></a>569       # Centered in the field, should be width/2.  Start, 0.
</span><span class="marked0"><a name="line570"></a>570       def y_label_offset( height )
</span><span class="uncovered1"><a name="line571"></a>571         0
</span><span class="uncovered0"><a name="line572"></a>572       end
</span><span class="inferred1"><a name="line573"></a>573 
</span><span class="inferred0"><a name="line574"></a>574 
</span><span class="marked1"><a name="line575"></a>575       def field_width
</span><span class="uncovered0"><a name="line576"></a>576         (@graph_width.to_f - font_size*2*right_font) /
</span><span class="uncovered1"><a name="line577"></a>577            (get_x_labels.length - right_align)
</span><span class="uncovered0"><a name="line578"></a>578       end
</span><span class="inferred1"><a name="line579"></a>579 
</span><span class="inferred0"><a name="line580"></a>580 
</span><span class="marked1"><a name="line581"></a>581       def field_height
</span><span class="uncovered0"><a name="line582"></a>582         (@graph_height.to_f - font_size*2*top_font) /
</span><span class="uncovered1"><a name="line583"></a>583            (get_y_labels.length - top_align)
</span><span class="uncovered0"><a name="line584"></a>584       end
</span><span class="inferred1"><a name="line585"></a>585 
</span><span class="inferred0"><a name="line586"></a>586 
</span><span class="inferred1"><a name="line587"></a>587       # Draws the Y axis labels
</span><span class="marked0"><a name="line588"></a>588       def draw_y_labels
</span><span class="uncovered1"><a name="line589"></a>589         stagger = y_label_font_size + 5
</span><span class="uncovered0"><a name="line590"></a>590         if show_y_labels
</span><span class="uncovered1"><a name="line591"></a>591           label_height = field_height
</span><span class="uncovered0"><a name="line592"></a>592 
</span><span class="uncovered1"><a name="line593"></a>593           count = 0
</span><span class="uncovered0"><a name="line594"></a>594           y_offset = @graph_height + y_label_offset( label_height )
</span><span class="uncovered1"><a name="line595"></a>595           y_offset += font_size/1.2 unless rotate_y_labels
</span><span class="uncovered0"><a name="line596"></a>596           for label in get_y_labels
</span><span class="uncovered1"><a name="line597"></a>597             y = y_offset - (label_height * count)
</span><span class="uncovered0"><a name="line598"></a>598             x = rotate_y_labels ? 0 : -3
</span><span class="uncovered1"><a name="line599"></a>599 
</span><span class="uncovered0"><a name="line600"></a>600             if stagger_y_labels and count % 2 == 1
</span><span class="uncovered1"><a name="line601"></a>601               x -= stagger
</span><span class="uncovered0"><a name="line602"></a>602               @graph.add_element( &quot;path&quot;, {
</span><span class="uncovered1"><a name="line603"></a>603                 &quot;d&quot; =&gt; &quot;M#{x} #{y} h#{stagger}&quot;,
</span><span class="uncovered0"><a name="line604"></a>604                 &quot;class&quot; =&gt; &quot;staggerGuideLine&quot;
</span><span class="uncovered1"><a name="line605"></a>605               })
</span><span class="uncovered0"><a name="line606"></a>606             end
</span><span class="uncovered1"><a name="line607"></a>607 
</span><span class="uncovered0"><a name="line608"></a>608             text = @graph.add_element( &quot;text&quot;, {
</span><span class="uncovered1"><a name="line609"></a>609               &quot;x&quot; =&gt; x.to_s,
</span><span class="uncovered0"><a name="line610"></a>610               &quot;y&quot; =&gt; y.to_s,
</span><span class="uncovered1"><a name="line611"></a>611               &quot;class&quot; =&gt; &quot;yAxisLabels&quot;
</span><span class="uncovered0"><a name="line612"></a>612             })
</span><span class="uncovered1"><a name="line613"></a>613             text.text = label.to_s
</span><span class="uncovered0"><a name="line614"></a>614             if rotate_y_labels
</span><span class="uncovered1"><a name="line615"></a>615               text.attributes[&quot;transform&quot;] = &quot;translate( -#{font_size} 0 ) &quot;+
</span><span class="uncovered0"><a name="line616"></a>616                 &quot;rotate( 90 #{x} #{y} ) &quot;
</span><span class="uncovered1"><a name="line617"></a>617               text.attributes[&quot;style&quot;] = &quot;text-anchor: middle&quot;
</span><span class="uncovered0"><a name="line618"></a>618             else
</span><span class="uncovered1"><a name="line619"></a>619               text.attributes[&quot;y&quot;] = (y - (y_label_font_size/2)).to_s
</span><span class="uncovered0"><a name="line620"></a>620               text.attributes[&quot;style&quot;] = &quot;text-anchor: end&quot;
</span><span class="uncovered1"><a name="line621"></a>621             end
</span><span class="uncovered0"><a name="line622"></a>622             draw_y_guidelines( label_height, count ) if show_y_guidelines
</span><span class="uncovered1"><a name="line623"></a>623             count += 1
</span><span class="uncovered0"><a name="line624"></a>624           end
</span><span class="uncovered1"><a name="line625"></a>625         end
</span><span class="uncovered0"><a name="line626"></a>626       end
</span><span class="inferred1"><a name="line627"></a>627 
</span><span class="inferred0"><a name="line628"></a>628 
</span><span class="inferred1"><a name="line629"></a>629       # Draws the X axis guidelines
</span><span class="marked0"><a name="line630"></a>630       def draw_x_guidelines( label_height, count )
</span><span class="uncovered1"><a name="line631"></a>631         if count != 0
</span><span class="uncovered0"><a name="line632"></a>632           @graph.add_element( &quot;path&quot;, {
</span><span class="uncovered1"><a name="line633"></a>633             &quot;d&quot; =&gt; &quot;M#{label_height*count} 0 v#@graph_height&quot;,
</span><span class="uncovered0"><a name="line634"></a>634             &quot;class&quot; =&gt; &quot;guideLines&quot;
</span><span class="uncovered1"><a name="line635"></a>635           })
</span><span class="uncovered0"><a name="line636"></a>636         end
</span><span class="uncovered1"><a name="line637"></a>637       end
</span><span class="inferred0"><a name="line638"></a>638 
</span><span class="inferred1"><a name="line639"></a>639 
</span><span class="inferred0"><a name="line640"></a>640       # Draws the Y axis guidelines
</span><span class="marked1"><a name="line641"></a>641       def draw_y_guidelines( label_height, count )
</span><span class="uncovered0"><a name="line642"></a>642         if count != 0
</span><span class="uncovered1"><a name="line643"></a>643           @graph.add_element( &quot;path&quot;, {
</span><span class="uncovered0"><a name="line644"></a>644             &quot;d&quot; =&gt; &quot;M0 #{@graph_height-(label_height*count)} h#@graph_width&quot;,
</span><span class="uncovered1"><a name="line645"></a>645             &quot;class&quot; =&gt; &quot;guideLines&quot;
</span><span class="uncovered0"><a name="line646"></a>646           })
</span><span class="uncovered1"><a name="line647"></a>647         end
</span><span class="uncovered0"><a name="line648"></a>648       end
</span><span class="inferred1"><a name="line649"></a>649 
</span><span class="inferred0"><a name="line650"></a>650 
</span><span class="inferred1"><a name="line651"></a>651       # Draws the graph title and subtitle
</span><span class="marked0"><a name="line652"></a>652       def draw_titles
</span><span class="uncovered1"><a name="line653"></a>653         if show_graph_title
</span><span class="uncovered0"><a name="line654"></a>654           @root.add_element( &quot;text&quot;, {
</span><span class="uncovered1"><a name="line655"></a>655             &quot;x&quot; =&gt; (width / 2).to_s,
</span><span class="uncovered0"><a name="line656"></a>656             &quot;y&quot; =&gt; (title_font_size).to_s,
</span><span class="uncovered1"><a name="line657"></a>657             &quot;class&quot; =&gt; &quot;mainTitle&quot;
</span><span class="uncovered0"><a name="line658"></a>658           }).text = graph_title.to_s
</span><span class="uncovered1"><a name="line659"></a>659         end
</span><span class="uncovered0"><a name="line660"></a>660 
</span><span class="uncovered1"><a name="line661"></a>661         if show_graph_subtitle
</span><span class="uncovered0"><a name="line662"></a>662           y_subtitle = show_graph_title ? 
</span><span class="uncovered1"><a name="line663"></a>663             title_font_size + 10 :
</span><span class="uncovered0"><a name="line664"></a>664             subtitle_font_size
</span><span class="uncovered1"><a name="line665"></a>665           @root.add_element(&quot;text&quot;, {
</span><span class="uncovered0"><a name="line666"></a>666             &quot;x&quot; =&gt; (width / 2).to_s,
</span><span class="uncovered1"><a name="line667"></a>667             &quot;y&quot; =&gt; (y_subtitle).to_s,
</span><span class="uncovered0"><a name="line668"></a>668             &quot;class&quot; =&gt; &quot;subTitle&quot;
</span><span class="uncovered1"><a name="line669"></a>669           }).text = graph_subtitle.to_s
</span><span class="uncovered0"><a name="line670"></a>670         end
</span><span class="uncovered1"><a name="line671"></a>671 
</span><span class="uncovered0"><a name="line672"></a>672         if show_x_title
</span><span class="uncovered1"><a name="line673"></a>673           y = @graph_height + @border_top + x_title_font_size
</span><span class="uncovered0"><a name="line674"></a>674           if show_x_labels
</span><span class="uncovered1"><a name="line675"></a>675             y += x_label_font_size + 5 if stagger_x_labels
</span><span class="uncovered0"><a name="line676"></a>676             y += x_label_font_size + 5
</span><span class="uncovered1"><a name="line677"></a>677           end
</span><span class="uncovered0"><a name="line678"></a>678           x = width / 2
</span><span class="uncovered1"><a name="line679"></a>679 
</span><span class="uncovered0"><a name="line680"></a>680           @root.add_element(&quot;text&quot;, {
</span><span class="uncovered1"><a name="line681"></a>681             &quot;x&quot; =&gt; x.to_s,
</span><span class="uncovered0"><a name="line682"></a>682             &quot;y&quot; =&gt; y.to_s,
</span><span class="uncovered1"><a name="line683"></a>683             &quot;class&quot; =&gt; &quot;xAxisTitle&quot;,
</span><span class="uncovered0"><a name="line684"></a>684           }).text = x_title.to_s
</span><span class="uncovered1"><a name="line685"></a>685         end
</span><span class="uncovered0"><a name="line686"></a>686 
</span><span class="uncovered1"><a name="line687"></a>687         if show_y_title
</span><span class="uncovered0"><a name="line688"></a>688           x = y_title_font_size + (y_title_text_direction==:bt ? 3 : -3)
</span><span class="uncovered1"><a name="line689"></a>689           y = height / 2
</span><span class="uncovered0"><a name="line690"></a>690 
</span><span class="uncovered1"><a name="line691"></a>691           text = @root.add_element(&quot;text&quot;, {
</span><span class="uncovered0"><a name="line692"></a>692             &quot;x&quot; =&gt; x.to_s,
</span><span class="uncovered1"><a name="line693"></a>693             &quot;y&quot; =&gt; y.to_s,
</span><span class="uncovered0"><a name="line694"></a>694             &quot;class&quot; =&gt; &quot;yAxisTitle&quot;,
</span><span class="uncovered1"><a name="line695"></a>695           })
</span><span class="uncovered0"><a name="line696"></a>696           text.text = y_title.to_s
</span><span class="uncovered1"><a name="line697"></a>697           if y_title_text_direction == :bt
</span><span class="uncovered0"><a name="line698"></a>698             text.attributes[&quot;transform&quot;] = &quot;rotate( -90, #{x}, #{y} )&quot;
</span><span class="uncovered1"><a name="line699"></a>699           else
</span><span class="uncovered0"><a name="line700"></a>700             text.attributes[&quot;transform&quot;] = &quot;rotate( 90, #{x}, #{y} )&quot;
</span><span class="uncovered1"><a name="line701"></a>701           end
</span><span class="uncovered0"><a name="line702"></a>702         end
</span><span class="uncovered1"><a name="line703"></a>703       end
</span><span class="inferred0"><a name="line704"></a>704 
</span><span class="marked1"><a name="line705"></a>705       def keys 
</span><span class="uncovered0"><a name="line706"></a>706         return @data.collect{ |d| d[:title] }
</span><span class="uncovered1"><a name="line707"></a>707       end
</span><span class="inferred0"><a name="line708"></a>708 
</span><span class="inferred1"><a name="line709"></a>709       # Draws the legend on the graph
</span><span class="marked0"><a name="line710"></a>710       def draw_legend
</span><span class="uncovered1"><a name="line711"></a>711         if key
</span><span class="uncovered0"><a name="line712"></a>712           group = @root.add_element( &quot;g&quot; )
</span><span class="uncovered1"><a name="line713"></a>713 
</span><span class="uncovered0"><a name="line714"></a>714           key_count = 0
</span><span class="uncovered1"><a name="line715"></a>715           for key_name in keys
</span><span class="uncovered0"><a name="line716"></a>716             y_offset = (KEY_BOX_SIZE * key_count) + (key_count * 5)
</span><span class="uncovered1"><a name="line717"></a>717             group.add_element( &quot;rect&quot;, {
</span><span class="uncovered0"><a name="line718"></a>718               &quot;x&quot; =&gt; 0.to_s,
</span><span class="uncovered1"><a name="line719"></a>719               &quot;y&quot; =&gt; y_offset.to_s,
</span><span class="uncovered0"><a name="line720"></a>720               &quot;width&quot; =&gt; KEY_BOX_SIZE.to_s,
</span><span class="uncovered1"><a name="line721"></a>721               &quot;height&quot; =&gt; KEY_BOX_SIZE.to_s,
</span><span class="uncovered0"><a name="line722"></a>722               &quot;class&quot; =&gt; &quot;key#{key_count+1}&quot;
</span><span class="uncovered1"><a name="line723"></a>723             })
</span><span class="uncovered0"><a name="line724"></a>724             group.add_element( &quot;text&quot;, {
</span><span class="uncovered1"><a name="line725"></a>725               &quot;x&quot; =&gt; (KEY_BOX_SIZE + 5).to_s,
</span><span class="uncovered0"><a name="line726"></a>726               &quot;y&quot; =&gt; (y_offset + KEY_BOX_SIZE).to_s,
</span><span class="uncovered1"><a name="line727"></a>727               &quot;class&quot; =&gt; &quot;keyText&quot;
</span><span class="uncovered0"><a name="line728"></a>728             }).text = key_name.to_s
</span><span class="uncovered1"><a name="line729"></a>729             key_count += 1
</span><span class="uncovered0"><a name="line730"></a>730           end
</span><span class="uncovered1"><a name="line731"></a>731 
</span><span class="uncovered0"><a name="line732"></a>732           case key_position
</span><span class="uncovered1"><a name="line733"></a>733           when :right
</span><span class="uncovered0"><a name="line734"></a>734             x_offset = @graph_width + @border_left + 10
</span><span class="uncovered1"><a name="line735"></a>735             y_offset = @border_top + 20
</span><span class="uncovered0"><a name="line736"></a>736           when :bottom
</span><span class="uncovered1"><a name="line737"></a>737             x_offset = @border_left + 20
</span><span class="uncovered0"><a name="line738"></a>738             y_offset = @border_top + @graph_height + 5
</span><span class="uncovered1"><a name="line739"></a>739             if show_x_labels
</span><span class="uncovered0"><a name="line740"></a>740 			  max_x_label_height_px = (not rotate_x_labels) ? 
</span><span class="uncovered1"><a name="line741"></a>741 				x_label_font_size :
</span><span class="uncovered0"><a name="line742"></a>742 				get_x_labels.max{|a,b| 
</span><span class="uncovered1"><a name="line743"></a>743 				  a.to_s.length&lt;=&gt;b.to_s.length
</span><span class="uncovered0"><a name="line744"></a>744 				}.to_s.length * x_label_font_size * 0.6
</span><span class="uncovered1"><a name="line745"></a>745                 x_label_font_size
</span><span class="uncovered0"><a name="line746"></a>746               y_offset += max_x_label_height_px
</span><span class="uncovered1"><a name="line747"></a>747               y_offset += max_x_label_height_px + 5 if stagger_x_labels
</span><span class="uncovered0"><a name="line748"></a>748             end
</span><span class="uncovered1"><a name="line749"></a>749             y_offset += x_title_font_size + 5 if show_x_title
</span><span class="uncovered0"><a name="line750"></a>750           end
</span><span class="uncovered1"><a name="line751"></a>751           group.attributes[&quot;transform&quot;] = &quot;translate(#{x_offset} #{y_offset})&quot;
</span><span class="uncovered0"><a name="line752"></a>752         end
</span><span class="uncovered1"><a name="line753"></a>753       end
</span><span class="inferred0"><a name="line754"></a>754 
</span><span class="inferred1"><a name="line755"></a>755 
</span><span class="marked0"><a name="line756"></a>756       private
</span><span class="inferred1"><a name="line757"></a>757 
</span><span class="marked0"><a name="line758"></a>758       def sort_multiple( arrys, lo=0, hi=arrys[0].length-1 )
</span><span class="uncovered1"><a name="line759"></a>759         if lo &lt; hi
</span><span class="uncovered0"><a name="line760"></a>760           p = partition(arrys,lo,hi)
</span><span class="uncovered1"><a name="line761"></a>761           sort_multiple(arrys, lo, p-1)
</span><span class="uncovered0"><a name="line762"></a>762           sort_multiple(arrys, p+1, hi)
</span><span class="uncovered1"><a name="line763"></a>763         end
</span><span class="uncovered0"><a name="line764"></a>764         arrys 
</span><span class="uncovered1"><a name="line765"></a>765       end
</span><span class="inferred0"><a name="line766"></a>766 
</span><span class="marked1"><a name="line767"></a>767       def partition( arrys, lo, hi )
</span><span class="uncovered0"><a name="line768"></a>768         p = arrys[0][lo]
</span><span class="uncovered1"><a name="line769"></a>769         l = lo
</span><span class="uncovered0"><a name="line770"></a>770         z = lo+1
</span><span class="uncovered1"><a name="line771"></a>771         while z &lt;= hi
</span><span class="uncovered0"><a name="line772"></a>772           if arrys[0][z] &lt; p
</span><span class="uncovered1"><a name="line773"></a>773             l += 1
</span><span class="uncovered0"><a name="line774"></a>774             arrys.each { |arry| arry[z], arry[l] = arry[l], arry[z] }
</span><span class="uncovered1"><a name="line775"></a>775           end
</span><span class="uncovered0"><a name="line776"></a>776           z += 1
</span><span class="uncovered1"><a name="line777"></a>777         end
</span><span class="uncovered0"><a name="line778"></a>778         arrys.each { |arry| arry[lo], arry[l] = arry[l], arry[lo] }
</span><span class="uncovered1"><a name="line779"></a>779         l
</span><span class="uncovered0"><a name="line780"></a>780       end
</span><span class="inferred1"><a name="line781"></a>781 
</span><span class="marked0"><a name="line782"></a>782       def style
</span><span class="uncovered1"><a name="line783"></a>783         if no_css
</span><span class="uncovered0"><a name="line784"></a>784           styles = parse_css
</span><span class="uncovered1"><a name="line785"></a>785           @root.elements.each(&quot;//*[@class]&quot;) { |el|
</span><span class="uncovered0"><a name="line786"></a>786             cl = el.attributes[&quot;class&quot;]
</span><span class="uncovered1"><a name="line787"></a>787             style = styles[cl]
</span><span class="uncovered0"><a name="line788"></a>788             style += el.attributes[&quot;style&quot;] if el.attributes[&quot;style&quot;]
</span><span class="uncovered1"><a name="line789"></a>789             el.attributes[&quot;style&quot;] = style
</span><span class="uncovered0"><a name="line790"></a>790           }
</span><span class="uncovered1"><a name="line791"></a>791         end
</span><span class="uncovered0"><a name="line792"></a>792       end
</span><span class="inferred1"><a name="line793"></a>793 
</span><span class="marked0"><a name="line794"></a>794       def parse_css
</span><span class="uncovered1"><a name="line795"></a>795         css = get_style
</span><span class="uncovered0"><a name="line796"></a>796         rv = {}
</span><span class="uncovered1"><a name="line797"></a>797         while css =~ /^(\.(\w+)(?:\s*,\s*\.\w+)*)\s*\{/m
</span><span class="uncovered0"><a name="line798"></a>798           names_orig = names = $1
</span><span class="uncovered1"><a name="line799"></a>799           css = $'
</span><span class="uncovered0"><a name="line800"></a>800           css =~ /([^}]+)\}/m
</span><span class="uncovered1"><a name="line801"></a>801           content = $1
</span><span class="uncovered0"><a name="line802"></a>802           css = $'
</span><span class="uncovered1"><a name="line803"></a>803 
</span><span class="uncovered0"><a name="line804"></a>804           nms = []
</span><span class="uncovered1"><a name="line805"></a>805           while names =~ /^\s*,?\s*\.(\w+)/
</span><span class="uncovered0"><a name="line806"></a>806             nms &lt;&lt; $1
</span><span class="uncovered1"><a name="line807"></a>807             names = $'
</span><span class="uncovered0"><a name="line808"></a>808           end
</span><span class="uncovered1"><a name="line809"></a>809 
</span><span class="uncovered0"><a name="line810"></a>810           content = content.tr( &quot;\n\t&quot;, &quot; &quot;)
</span><span class="uncovered1"><a name="line811"></a>811           for name in nms
</span><span class="uncovered0"><a name="line812"></a>812             current = rv[name]
</span><span class="uncovered1"><a name="line813"></a>813             current = current ? current+&quot;; &quot;+content : content
</span><span class="uncovered0"><a name="line814"></a>814             rv[name] = current.strip.squeeze(&quot; &quot;)
</span><span class="uncovered1"><a name="line815"></a>815           end
</span><span class="uncovered0"><a name="line816"></a>816         end
</span><span class="uncovered1"><a name="line817"></a>817         return rv
</span><span class="uncovered0"><a name="line818"></a>818       end
</span><span class="inferred1"><a name="line819"></a>819 
</span><span class="inferred0"><a name="line820"></a>820 
</span><span class="inferred1"><a name="line821"></a>821       # Override and place code to add defs here
</span><span class="marked0"><a name="line822"></a>822       def add_defs defs
</span><span class="inferred1"><a name="line823"></a>823       end
</span><span class="inferred0"><a name="line824"></a>824 
</span><span class="inferred1"><a name="line825"></a>825 
</span><span class="marked0"><a name="line826"></a>826       def start_svg
</span><span class="uncovered1"><a name="line827"></a>827         # Base document
</span><span class="uncovered0"><a name="line828"></a>828         @doc = Document.new
</span><span class="uncovered1"><a name="line829"></a>829         @doc &lt;&lt; XMLDecl.new
</span><span class="uncovered0"><a name="line830"></a>830         @doc &lt;&lt; DocType.new( %q{svg PUBLIC &quot;-//W3C//DTD SVG 1.0//EN&quot; } +
</span><span class="uncovered1"><a name="line831"></a>831           %q{&quot;http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd&quot;} )
</span><span class="uncovered0"><a name="line832"></a>832         if style_sheet &amp;&amp; style_sheet != ''
</span><span class="uncovered1"><a name="line833"></a>833           @doc &lt;&lt; Instruction.new( &quot;xml-stylesheet&quot;,
</span><span class="uncovered0"><a name="line834"></a>834             %Q{href=&quot;#{style_sheet}&quot; type=&quot;text/css&quot;} )
</span><span class="uncovered1"><a name="line835"></a>835         end
</span><span class="uncovered0"><a name="line836"></a>836         @root = @doc.add_element( &quot;svg&quot;, {
</span><span class="uncovered1"><a name="line837"></a>837           &quot;width&quot; =&gt; width.to_s,
</span><span class="uncovered0"><a name="line838"></a>838           &quot;height&quot; =&gt; height.to_s,
</span><span class="uncovered1"><a name="line839"></a>839           &quot;viewBox&quot; =&gt; &quot;0 0 #{width} #{height}&quot;,
</span><span class="uncovered0"><a name="line840"></a>840           &quot;xmlns&quot; =&gt; &quot;http://www.w3.org/2000/svg&quot;,
</span><span class="uncovered1"><a name="line841"></a>841           &quot;xmlns:xlink&quot; =&gt; &quot;http://www.w3.org/1999/xlink&quot;,
</span><span class="uncovered0"><a name="line842"></a>842           &quot;xmlns:a3&quot; =&gt; &quot;http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/&quot;,
</span><span class="uncovered1"><a name="line843"></a>843           &quot;a3:scriptImplementation&quot; =&gt; &quot;Adobe&quot;
</span><span class="uncovered0"><a name="line844"></a>844         })
</span><span class="uncovered1"><a name="line845"></a>845         @root &lt;&lt; Comment.new( &quot; &quot;+&quot;\\&quot;*66 )
</span><span class="uncovered0"><a name="line846"></a>846         @root &lt;&lt; Comment.new( &quot; Created with SVG::Graph &quot; )
</span><span class="uncovered1"><a name="line847"></a>847         @root &lt;&lt; Comment.new( &quot; SVG::Graph by Sean E. Russell &quot; )
</span><span class="uncovered0"><a name="line848"></a>848         @root &lt;&lt; Comment.new( &quot; Losely based on SVG::TT::Graph for Perl by&quot;+
</span><span class="uncovered1"><a name="line849"></a>849         &quot; Leo Lapworth &amp; Stephan Morgan &quot; )
</span><span class="uncovered0"><a name="line850"></a>850         @root &lt;&lt; Comment.new( &quot; &quot;+&quot;/&quot;*66 )
</span><span class="uncovered1"><a name="line851"></a>851 
</span><span class="uncovered0"><a name="line852"></a>852         defs = @root.add_element( &quot;defs&quot; )
</span><span class="uncovered1"><a name="line853"></a>853         add_defs defs
</span><span class="uncovered0"><a name="line854"></a>854         if not(style_sheet &amp;&amp; style_sheet != '') and !no_css
</span><span class="uncovered1"><a name="line855"></a>855           @root &lt;&lt; Comment.new(&quot; include default stylesheet if none specified &quot;)
</span><span class="uncovered0"><a name="line856"></a>856           style = defs.add_element( &quot;style&quot;, {&quot;type&quot;=&gt;&quot;text/css&quot;} )
</span><span class="uncovered1"><a name="line857"></a>857           style &lt;&lt; CData.new( get_style )
</span><span class="uncovered0"><a name="line858"></a>858         end
</span><span class="uncovered1"><a name="line859"></a>859 
</span><span class="uncovered0"><a name="line860"></a>860         @root &lt;&lt; Comment.new( &quot;SVG Background&quot; )
</span><span class="uncovered1"><a name="line861"></a>861         @root.add_element( &quot;rect&quot;, {
</span><span class="uncovered0"><a name="line862"></a>862           &quot;width&quot; =&gt; width.to_s,
</span><span class="uncovered1"><a name="line863"></a>863           &quot;height&quot; =&gt; height.to_s,
</span><span class="uncovered0"><a name="line864"></a>864           &quot;x&quot; =&gt; &quot;0&quot;,
</span><span class="uncovered1"><a name="line865"></a>865           &quot;y&quot; =&gt; &quot;0&quot;,
</span><span class="uncovered0"><a name="line866"></a>866           &quot;class&quot; =&gt; &quot;svgBackground&quot;
</span><span class="uncovered1"><a name="line867"></a>867         })
</span><span class="uncovered0"><a name="line868"></a>868       end
</span><span class="inferred1"><a name="line869"></a>869 
</span><span class="inferred0"><a name="line870"></a>870 
</span><span class="marked1"><a name="line871"></a>871       def calculate_graph_dimensions
</span><span class="uncovered0"><a name="line872"></a>872         calculate_left_margin
</span><span class="uncovered1"><a name="line873"></a>873         calculate_right_margin
</span><span class="uncovered0"><a name="line874"></a>874         calculate_bottom_margin
</span><span class="uncovered1"><a name="line875"></a>875         calculate_top_margin
</span><span class="uncovered0"><a name="line876"></a>876         @graph_width = width - @border_left - @border_right
</span><span class="uncovered1"><a name="line877"></a>877         @graph_height = height - @border_top - @border_bottom
</span><span class="uncovered0"><a name="line878"></a>878       end
</span><span class="inferred1"><a name="line879"></a>879 
</span><span class="marked0"><a name="line880"></a>880       def get_style
</span><span class="uncovered1"><a name="line881"></a>881         return &lt;&lt;EOL
</span><span class="uncovered0"><a name="line882"></a>882 /* Copy from here for external style sheet */
</span><span class="uncovered1"><a name="line883"></a>883 .svgBackground{
</span><span class="uncovered0"><a name="line884"></a>884   fill:#ffffff;
</span><span class="uncovered1"><a name="line885"></a>885 }
</span><span class="uncovered0"><a name="line886"></a>886 .graphBackground{
</span><span class="uncovered1"><a name="line887"></a>887   fill:#f0f0f0;
</span><span class="uncovered0"><a name="line888"></a>888 }
</span><span class="uncovered1"><a name="line889"></a>889 
</span><span class="uncovered0"><a name="line890"></a>890 /* graphs titles */
</span><span class="uncovered1"><a name="line891"></a>891 .mainTitle{
</span><span class="uncovered0"><a name="line892"></a>892   text-anchor: middle;
</span><span class="uncovered1"><a name="line893"></a>893   fill: #000000;
</span><span class="uncovered0"><a name="line894"></a>894   font-size: #{title_font_size}px;
</span><span class="uncovered1"><a name="line895"></a>895   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line896"></a>896   font-weight: normal;
</span><span class="uncovered1"><a name="line897"></a>897 }
</span><span class="uncovered0"><a name="line898"></a>898 .subTitle{
</span><span class="uncovered1"><a name="line899"></a>899   text-anchor: middle;
</span><span class="uncovered0"><a name="line900"></a>900   fill: #999999;
</span><span class="uncovered1"><a name="line901"></a>901   font-size: #{subtitle_font_size}px;
</span><span class="uncovered0"><a name="line902"></a>902   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered1"><a name="line903"></a>903   font-weight: normal;
</span><span class="uncovered0"><a name="line904"></a>904 }
</span><span class="uncovered1"><a name="line905"></a>905 
</span><span class="uncovered0"><a name="line906"></a>906 .axis{
</span><span class="uncovered1"><a name="line907"></a>907   stroke: #000000;
</span><span class="uncovered0"><a name="line908"></a>908   stroke-width: 1px;
</span><span class="uncovered1"><a name="line909"></a>909 }
</span><span class="uncovered0"><a name="line910"></a>910 
</span><span class="uncovered1"><a name="line911"></a>911 .guideLines{
</span><span class="uncovered0"><a name="line912"></a>912   stroke: #666666;
</span><span class="uncovered1"><a name="line913"></a>913   stroke-width: 1px;
</span><span class="uncovered0"><a name="line914"></a>914   stroke-dasharray: 5 5;
</span><span class="uncovered1"><a name="line915"></a>915 }
</span><span class="uncovered0"><a name="line916"></a>916 
</span><span class="uncovered1"><a name="line917"></a>917 .xAxisLabels{
</span><span class="uncovered0"><a name="line918"></a>918   text-anchor: middle;
</span><span class="uncovered1"><a name="line919"></a>919   fill: #000000;
</span><span class="uncovered0"><a name="line920"></a>920   font-size: #{x_label_font_size}px;
</span><span class="uncovered1"><a name="line921"></a>921   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line922"></a>922   font-weight: normal;
</span><span class="uncovered1"><a name="line923"></a>923 }
</span><span class="uncovered0"><a name="line924"></a>924 
</span><span class="uncovered1"><a name="line925"></a>925 .yAxisLabels{
</span><span class="uncovered0"><a name="line926"></a>926   text-anchor: end;
</span><span class="uncovered1"><a name="line927"></a>927   fill: #000000;
</span><span class="uncovered0"><a name="line928"></a>928   font-size: #{y_label_font_size}px;
</span><span class="uncovered1"><a name="line929"></a>929   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line930"></a>930   font-weight: normal;
</span><span class="uncovered1"><a name="line931"></a>931 }
</span><span class="uncovered0"><a name="line932"></a>932 
</span><span class="uncovered1"><a name="line933"></a>933 .xAxisTitle{
</span><span class="uncovered0"><a name="line934"></a>934   text-anchor: middle;
</span><span class="uncovered1"><a name="line935"></a>935   fill: #ff0000;
</span><span class="uncovered0"><a name="line936"></a>936   font-size: #{x_title_font_size}px;
</span><span class="uncovered1"><a name="line937"></a>937   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line938"></a>938   font-weight: normal;
</span><span class="uncovered1"><a name="line939"></a>939 }
</span><span class="uncovered0"><a name="line940"></a>940 
</span><span class="uncovered1"><a name="line941"></a>941 .yAxisTitle{
</span><span class="uncovered0"><a name="line942"></a>942   fill: #ff0000;
</span><span class="uncovered1"><a name="line943"></a>943   text-anchor: middle;
</span><span class="uncovered0"><a name="line944"></a>944   font-size: #{y_title_font_size}px;
</span><span class="uncovered1"><a name="line945"></a>945   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line946"></a>946   font-weight: normal;
</span><span class="uncovered1"><a name="line947"></a>947 }
</span><span class="uncovered0"><a name="line948"></a>948 
</span><span class="uncovered1"><a name="line949"></a>949 .dataPointLabel{
</span><span class="uncovered0"><a name="line950"></a>950   fill: #000000;
</span><span class="uncovered1"><a name="line951"></a>951   text-anchor:middle;
</span><span class="uncovered0"><a name="line952"></a>952   font-size: 10px;
</span><span class="uncovered1"><a name="line953"></a>953   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line954"></a>954   font-weight: normal;
</span><span class="uncovered1"><a name="line955"></a>955 }
</span><span class="uncovered0"><a name="line956"></a>956 
</span><span class="uncovered1"><a name="line957"></a>957 .staggerGuideLine{
</span><span class="uncovered0"><a name="line958"></a>958   fill: none;
</span><span class="uncovered1"><a name="line959"></a>959   stroke: #000000;
</span><span class="uncovered0"><a name="line960"></a>960   stroke-width: 0.5px;  
</span><span class="uncovered1"><a name="line961"></a>961 }
</span><span class="uncovered0"><a name="line962"></a>962 
</span><span class="uncovered1"><a name="line963"></a>963 #{get_css}
</span><span class="uncovered0"><a name="line964"></a>964 
</span><span class="uncovered1"><a name="line965"></a>965 .keyText{
</span><span class="uncovered0"><a name="line966"></a>966   fill: #000000;
</span><span class="uncovered1"><a name="line967"></a>967   text-anchor:start;
</span><span class="uncovered0"><a name="line968"></a>968   font-size: #{key_font_size}px;
</span><span class="uncovered1"><a name="line969"></a>969   font-family: &quot;Arial&quot;, sans-serif;
</span><span class="uncovered0"><a name="line970"></a>970   font-weight: normal;
</span><span class="uncovered1"><a name="line971"></a>971 }
</span><span class="uncovered0"><a name="line972"></a>972 /* End copy for external style sheet */
</span><span class="uncovered1"><a name="line973"></a>973 EOL
</span><span class="uncovered0"><a name="line974"></a>974       end
</span><span class="uncovered1"><a name="line975"></a>975 
</span><span class="uncovered0"><a name="line976"></a>976     end
</span><span class="uncovered1"><a name="line977"></a>977   end
</span><span class="uncovered0"><a name="line978"></a>978 end
</span></pre><hr/>
    <p>Generated using the <a href='http://eigenclass.org/hiki.rb?rcov'>rcov code coverage analysis tool for Ruby</a>
   version 0.8.1.2.</p>
<p><a href='http://validator.w3.org/check/referer'><img src='http://www.w3.org/Icons/valid-xhtml10' height='31' alt='Valid XHTML 1.0!' width='88'/>
        </a>
      <a href='http://jigsaw.w3.org/css-validator/check/referer'><img src='http://jigsaw.w3.org/css-validator/images/vcss' alt='Valid CSS!' style='border:0;width:88px;height:31px'/>
        </a>
      </p>
    </body>
  </html>
